<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>„Çπ„Éº„Éë„Éº„Åè„Åò</title>
<style>
  body {
    margin:0; height:100vh; overflow:hidden;
    background:linear-gradient(135deg,#1e3c72,#2a5298);
    display:flex; align-items:center; justify-content:center;
    font-family:"Noto Sans JP",sans-serif; color:#fff;
  }
  canvas.bg {position:absolute;top:0;left:0;width:100%;height:100%;}
  .card {
    width:220px; height:320px;
    background:#fff url('https://picsum.photos/220/320') center/cover no-repeat;
    border-radius:20px; box-shadow:0 10px 30px rgba(0,0,0,0.4);
    display:flex;align-items:end;justify-content:center;
    cursor:pointer; z-index:10; transition:transform .3s;
  }
  .card:active { transform:scale(0.95); }
  .title {
    background:rgba(0,0,0,0.5); color:#fff;
    padding:10px; border-radius:0 0 20px 20px;
    width:100%; text-align:center; font-weight:bold;
  }
  .confetti {
    position:absolute; width:10px; height:10px;
    top:-10px; animation:fall linear forwards;
  }
  @keyframes fall {to {transform:translateY(110vh) rotate(720deg); opacity:0;}}
</style>
</head>
<body>
<canvas class="bg"></canvas>
<div class="card" id="kuji">
  <div class="title">Âºï„ÅÑ„Å¶„Å≠ÔºÅ</div>
</div>

<script>
const kuji=document.getElementById('kuji');
const prizes=["üéÅ AË≥û - „ÇÆ„Éï„ÉàÂà∏","üç¨ BË≥û - „ÅäËèìÂ≠ê","ü•§ CË≥û - „Éâ„É™„É≥„ÇØ","üò≠ „Éè„Ç∫„É¨"];
let canDraw=true;

// ÂÖ±ÈÄö ÊäΩÈÅ∏Èñ¢Êï∞
function drawPrize(){
  if(!canDraw) return;
  canDraw=false;
  kuji.style.transform="translateY(-100vh) scale(1.2)";
  setTimeout(()=>{
    const prize=prizes[Math.floor(Math.random()*prizes.length)];
    alert("ÁµêÊûú: "+prize);
    startConfetti();
    kuji.style.transform="";
    canDraw=true;
  },800);
}

// üéÆ Êìç‰Ωú„Ç§„Éô„É≥„Éà --------------------
// 1. „Çø„ÉÉ„Éó
kuji.addEventListener("click", drawPrize);

// 2. „Çπ„ÉØ„Ç§„Éó
let startY=0;
kuji.addEventListener("touchstart",e=>startY=e.touches[0].clientY);
kuji.addEventListener("touchend",e=>{
  let endY=e.changedTouches[0].clientY;
  if(startY-endY>80) drawPrize(); // ‰∏ä„Çπ„ÉØ„Ç§„Éó
});

// 3. „Çπ„ÇØ„É≠„Éº„É´Ôºà‰∏ãÊñπÂêëÔºâ
let scrollStart=0;
kuji.addEventListener("touchmove",e=>{
  let dy=e.touches[0].clientY-(scrollStart||e.touches[0].clientY);
  if(dy>120){ drawPrize(); scrollStart=0; }
});
kuji.addEventListener("touchstart",e=>scrollStart=e.touches[0].clientY);

// 4. ÂÇæ„Åë„Çã
window.addEventListener("deviceorientation",e=>{
  if(Math.abs(e.gamma)>30) drawPrize(); // Â∑¶Âè≥ÂÇæ„Åë
});

// 5. „Ç∑„Çß„Ç§„ÇØ
let lastX=0,lastY=0,lastZ=0,lastTime=0;
window.addEventListener("devicemotion",e=>{
  const acc=e.accelerationIncludingGravity;
  const cur=Date.now();
  if(cur-lastTime>200){
    const speed=Math.abs(acc.x+acc.y+acc.z-lastX-lastY-lastZ)/(cur-lastTime)*10000;
    if(speed>2500) drawPrize();
    lastTime=cur; lastX=acc.x; lastY=acc.y; lastZ=acc.z;
  }
});

// üéâ Á¥ôÂêπÈõ™
function startConfetti(){
  for(let i=0;i<50;i++){
    const c=document.createElement("div");
    c.className="confetti";
    c.style.left=Math.random()*100+"vw";
    c.style.background=`hsl(${Math.random()*360},100%,50%)`;
    c.style.animationDuration=(3+Math.random()*2)+"s";
    document.body.appendChild(c);
    setTimeout(()=>c.remove(),5000);
  }
}

// ‚ú® ËÉåÊôØ„Ç≠„É©„Ç≠„É©ÔºàcanvasÔºâ
const canvas=document.querySelector("canvas.bg");
const ctx=canvas.getContext("2d");
canvas.width=innerWidth; canvas.height=innerHeight;
let stars=[];
for(let i=0;i<100;i++){
  stars.push({x:Math.random()*canvas.width,
              y:Math.random()*canvas.height,
              r:Math.random()*2+1,
              s:Math.random()*0.5+0.2});
}
function animateStars(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle="white";
  stars.forEach(st=>{
    ctx.beginPath();
    ctx.arc(st.x,st.y,st.r,0,Math.PI*2);
    ctx.fill();
    st.y+=st.s;
    if(st.y>canvas.height){st.y=0;st.x=Math.random()*canvas.width;}
  });
  requestAnimationFrame(animateStars);
}
animateStars();
</script>
</body>
</html>
